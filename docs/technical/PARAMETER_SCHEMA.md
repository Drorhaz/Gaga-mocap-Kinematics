# Parameter Schema - Master Quality Report (NB07)

This document describes all JSON parameters extracted by the Master Quality Report.

**Generated:** 2026-01-23 21:21:11

---

## Section Overview

| Section | Name | Description |
|---------|------|-------------|
| S0 | Data Lineage & Provenance | Report section |
| S1 | Rácz Calibration Layer | Report section |
| S2 | Temporal Quality & Sampling | Report section |
| S3 | Gap & Interpolation Transparency | Report section |
| S4 | Winter's Residual Validation | Report section |
| S5 | Reference Detection & Stability | Report section |
| S6 | Biomechanics & Outlier Analysis | Report section |
| S7 | Signal-to-Noise Quantification | Report section |
| S8 | Decision Matrix | Report section |

---

## step_01: Raw data loader report - initial parsing of OptiTrack CSV exports. Validates file integrity, extracts metadata, and computes initial quality metrics. Generated by notebooks/01_parse_csv.ipynb

**File Suffix:** `__step01_loader_report.json`

| Parameter Path | Type | Section | Description |
|----------------|------|---------|-------------|
| `identity.run_id` | str | S0 | Unique recording identifier extracted from filename. Format: {SubjectID}_{SessionID}_{PoseID}_{RepID}_Take {timestamp}. Used as primary key throughout pipeline. Code: notebooks/01_parse_csv.ipynb -> parse_take_name() |
| `identity.processing_timestamp` | str | S0 | ISO 8601 timestamp when this pipeline step executed. Used for audit trail and reproducibility tracking. Format: YYYY-MM-DD HH:MM:SS |
| `identity.pipeline_version` | str | S0 | Semantic version of pipeline code (e.g., v2.6_calibration_enhanced). Enables backward compatibility checks and regression tracking. Set in config/config_v1.yaml |
| `identity.csv_source` | str | S0 | Relative path to source CSV file from project root. Preserves data lineage per Cereatti et al. (2024) recommendations for motion capture provenance |
| `raw_data_quality.total_frames` | int | S2 | Total number of frames (rows) in the raw CSV after header parsing. At 120Hz: 7200 frames = 1 minute. Used to validate recording completeness and compute duration |
| `raw_data_quality.missing_data_percent` | str | S3 | Percentage of NaN/empty cells in position and rotation columns. Formula: $\frac{\text{NaN cells}}{\text{total cells}} \times 100$. Threshold: <5% acceptable, >10% requires review. Code: notebooks/01_parse_csv.ipynb -> compute_missing_stats() |
| `raw_data_quality.sampling_rate_actual` | float | S2 | Computed sampling rate from timestamp column. Formula: $f_s = \frac{N-1}{t_{N-1} - t_0}$ Hz. Expected: 120.0 Hz for OptiTrack. Deviation >1% triggers warning. Code: notebooks/01_parse_csv.ipynb -> compute_sampling_rate() |
| `raw_data_quality.optitrack_mean_error_mm` | float | S1 | OptiTrack system calibration error from Motive export metadata. Reflects volume calibration quality per Rácz et al. (2025) Calibration Layer. Thresholds: GOLD<0.5mm (research-grade), SILVER 0.5-1mm (acceptable), BRONZE>1mm (review needed). Extracted from CSV header |
| `raw_data_quality.optitrack_version` | str | S0 | OptiTrack Motive software version string from CSV header. Important for tracking API changes and known issues. Format: 'Motive X.Y.Z' |
| `calibration.pointer_tip_rms_error_mm` | float | S1 | RMS error of pointer tip during anatomical landmark digitization. Measures precision of virtual marker placement on bony landmarks. Formula: $RMS = \sqrt{\frac{1}{n}\sum_{i=1}^{n}(x_i - \bar{x})^2}$. Threshold: <1mm for accurate joint center estimation. Ref: CAST technique (Cappozzo et al., 1995) |
| `calibration.wand_error_mm` | float | S1 | Wand calibration error for capture volume. Indicates spatial accuracy of marker reconstruction across the capture space. Threshold: <0.5mm for sub-millimeter accuracy. Affects all downstream position calculations |
| `calibration.export_date` | str | S0 | Date when data was exported from Motive. Format: YYYY-MM-DD. Used to correlate with calibration logs and session notes |
| `skeleton_info.segments_found_count` | int | S1 | Number of skeleton segments successfully parsed from CSV columns. Expected: 21 for full-body (Hips, Spine, Spine1, Neck, Head, L/R Shoulder/Arm/ForeArm/Hand, L/R UpLeg/Leg/Foot/ToeBase). Missing segments indicate tracking dropout or export issues |
| `skeleton_info.segments_missing_count` | int | S1 | Number of expected skeleton segments not found in CSV. Non-zero indicates partial export or tracking failure. Critical segments: Hips (root), Head (endpoint). Code: notebooks/01_parse_csv.ipynb -> validate_skeleton() |
| `duration_sec` | float | S2 | Recording duration in seconds. Formula: $T = \frac{N_{frames}}{f_s}$. Minimum viable: 30s for statistical analysis, 60s+ recommended for movement characterization. Used for intensity normalization |

---

## step_02: Preprocessing summary - gap filling, quaternion normalization, and bone length stability analysis. Implements 'No Silent Fixes' transparency per Winter (2009). Generated by notebooks/02_preprocess.ipynb

**File Suffix:** `__preprocess_summary.json`

| Parameter Path | Type | Section | Description |
|----------------|------|---------|-------------|
| `run_id` | str | S0 | Recording identifier matching step_01. Ensures traceability across pipeline steps |
| `raw_missing_percent` | float | S3 | Missing data percentage BEFORE gap filling. Baseline for interpolation impact assessment. High values (>5%) indicate tracking occlusions or marker dropout. Code: notebooks/02_preprocess.ipynb -> compute_gap_statistics() |
| `post_missing_percent` | float | S3 | Missing data percentage AFTER gap filling. Should approach 0% if gaps were fillable. Remaining gaps indicate unfillable regions (too long or at boundaries). Delta from raw_missing shows interpolation effectiveness |
| `max_interpolation_gap` | int | S3 | Maximum gap length (frames) that was interpolated. Configurable threshold in config_v1.yaml. Default: 12 frames (100ms at 120Hz). Longer gaps are left unfilled to avoid hallucinating movement. Ref: Robertson et al. (2013) gap filling guidelines |
| `bone_qc_mean_cv` | float | S1 | Mean coefficient of variation for all bone segment lengths across recording. Formula: $\overline{CV} = \frac{1}{N_b}\sum_{b=1}^{N_b}\frac{\sigma_b}{\mu_b} \times 100\%$ where $\sigma_b$ = std of bone b length, $\mu_b$ = mean length. Measures skeleton rigidity assumption validity. Thresholds per Rácz et al. (2025): GOLD<0.5% (rigid body), SILVER 0.5-1% (acceptable), BRONZE 1-2% (soft tissue artifact), FAIL>2% (tracking error). Code: notebooks/02_preprocess.ipynb -> compute_bone_cv() |
| `bone_qc_status` | str | S1 | Categorical assessment of bone stability: GOLD/SILVER/BRONZE/FAIL. Based on mean CV thresholds. FAIL triggers pipeline warning and requires manual review. Used in score_calibration() quality scoring |
| `bone_qc_alerts` | list | S1 | List of specific bone segments with CV > threshold. Format: ['LeftForeArm: 1.8%', 'RightHand: 2.1%']. Identifies problematic segments for targeted review. High CV in distal segments (hands/feet) is common due to soft tissue |
| `worst_bone` | str | S1 | Bone segment with highest CV value. Primary candidate for visual inspection. Persistent issues in same bone across recordings may indicate marker placement problem or subject-specific anatomy |
| `interpolation_method` | str | S3 | Primary interpolation method used for gap filling. Options: 'linear_quaternion_normalized' (SLERP for rotations, linear for positions), 'cubic_spline', 'pchip'. SLERP preserves unit quaternion constraint. Code: notebooks/02_preprocess.ipynb -> interpolate_gaps() |

---

## step_03: Resampling summary - temporal grid uniformization and interpolation validation. Ensures constant sampling rate for frequency-domain analysis. Generated by notebooks/03_resample.ipynb

**File Suffix:** `__resample_summary.json`

| Parameter Path | Type | Section | Description |
|----------------|------|---------|-------------|
| `run_id` | str | S0 | Recording identifier for pipeline continuity |
| `target_fs` | float | S2 | Target uniform sampling frequency in Hz. Default: 120.0 Hz (matches OptiTrack native rate). All recordings resampled to this rate for cross-recording comparability. Set in config/config_v1.yaml -> fs_target |
| `time_grid_std_dt` | float | S2 | Standard deviation of time intervals after resampling. Formula: $\sigma_{\Delta t} = \sqrt{\frac{1}{N-1}\sum_{i=1}^{N-1}(\Delta t_i - \overline{\Delta t})^2}$. Ideal: 0.0 (perfectly uniform grid). Non-zero indicates numerical precision limits or edge effects. Code: notebooks/03_resample.ipynb -> validate_time_grid() |
| `temporal_status` | str | S2 | Categorical temporal grid quality: PERFECT (std=0), GOOD (std<0.1ms), REVIEW (std 0.1-1ms), FAIL (std>1ms). PERFECT required for accurate frequency analysis. Affects score_temporal_quality() scoring |
| `interpolation_methods.positions` | str | S3 | Interpolation method for 3D position data during resampling. 'CubicSpline' preferred for C2 continuity (smooth velocity/acceleration). Linear fallback for edge cases. Code: notebooks/03_resample.ipynb -> resample_positions() |
| `interpolation_methods.rotations` | str | S3 | Interpolation method for rotation data (quaternions). 'SLERP' (Spherical Linear Interpolation) required to maintain unit quaternion constraint and geodesic path on SO(3). Formula: $q(t) = \frac{\sin((1-t)\theta)}{\sin\theta}q_0 + \frac{\sin(t\theta)}{\sin\theta}q_1$. Ref: Shoemake (1985). Code: notebooks/03_resample.ipynb -> resample_rotations() |

---

## step_04: Filtering summary - Winter residual analysis for optimal cutoff selection and Butterworth low-pass filtering. Implements data-driven frequency selection per Winter (2009). Generated by notebooks/04_filtering.ipynb

**File Suffix:** `__filtering_summary.json`

| Parameter Path | Type | Section | Description |
|----------------|------|---------|-------------|
| `run_id` | str | S0 | Recording identifier for traceability |
| `identity.timestamp` | str | S0 | Processing timestamp for this filtering run. Useful for debugging filter parameter changes over time |
| `identity.pipeline_version` | str | S0 | Pipeline version at filtering time. Filter parameters may change between versions |
| `subject_metadata.mass_kg` | float | S0 | Subject body mass in kg from data/subject_metadata.json. Used for intensity index normalization and biomechanical plausibility checks. Default: 70kg if not specified |
| `subject_metadata.height_cm` | float | S0 | Subject height in cm from metadata. Used for anthropometric validation and scaling. Cross-checked against skeleton measurements |
| `raw_quality.total_frames` | int | S2 | Frame count at filtering stage. Should match step_01 unless trimming occurred |
| `raw_quality.sampling_rate_actual` | float | S2 | Confirmed sampling rate for Nyquist frequency calculation. Filter cutoff must be < fs/2 |
| `filter_params.filter_type` | str | S4 | Human-readable filter description. e.g., 'Butterworth Low-Pass, Order 2, Zero-Lag (filtfilt)'. Documents exact filter configuration |
| `filter_params.filter_method` | str | S4 | Filter selection method. Options: 'Winter Residual Analysis' (data-driven), 'Fixed Cutoff' (manual), 'Per-Region Winter Cutoff Selection' (region-specific). Per-region applies different cutoffs to proximal vs distal segments |
| `filter_params.filter_cutoff_hz` | float | S4 | Selected low-pass filter cutoff frequency in Hz. Winter method finds knee-point: $f_c = \arg\min_{f} \{RMS(f) : \frac{d(RMS)}{df} < \epsilon\}$. Typical dance range: 4-12 Hz. Lower cutoff = more smoothing, higher = preserves fast movements. Code: notebooks/04_filtering.ipynb -> winter_residual_analysis() |
| `filter_params.filter_range_hz` | list | S4 | Search range [min, max] for Winter analysis. Default: [1, 12] Hz. Expanded to [1, 16] Hz for Gaga dance with rapid distal movements. Set in config_v1.yaml |
| `filter_params.filter_order` | int | S4 | Butterworth filter order N. Effective order = 2N due to forward-backward (filtfilt) application. Default: 2 (4th order effective). Higher order = sharper cutoff but more ringing. Code: scipy.signal.butter() |
| `filter_params.winter_analysis_failed` | bool | S4 | True if Winter analysis could not find valid knee-point. Causes: insufficient data, no clear noise floor, or residual curve doesn't converge. Triggers fallback to fixed cutoff (6 Hz default) |
| `filter_params.winter_failure_reason` | str | S4 | Diagnostic message when Winter analysis fails. e.g., 'No knee-point found - residual monotonically decreasing', 'Insufficient frequency range'. Guides manual review |
| `filter_params.decision_reason` | str | S4 | Human-readable rationale for cutoff selection. e.g., 'Winter knee-point at 8.5 Hz', 'Fallback to 6 Hz due to analysis failure', 'Per-region: Arms=10Hz, Legs=7Hz, Spine=5Hz' |
| `filter_params.residual_rms_mm` | float | S4 | RMS of filter residual (raw - filtered) at selected cutoff. Formula: $RMS = \sqrt{\frac{1}{n}\sum_{i=1}^{n}(x_{raw,i}-x_{filt,i})^2}$. Quantifies 'price of smoothing' - how much signal removed. Policy: GOLD<15mm (minimal smoothing), SILVER 15-30mm (acceptable), REVIEW>30mm (excessive). Code: notebooks/04_filtering.ipynb -> compute_residual_rms() |
| `filter_params.residual_slope` | float | S4 | Slope of residual-vs-frequency curve at knee-point. Indicates convergence quality. Near-zero slope = clear transition between signal and noise. Steep slope = ambiguous cutoff region |
| `filter_params.biomechanical_guardrails.enabled` | bool | S4 | Whether biomechanical plausibility checks were applied post-filtering. Guardrails flag physically impossible values (e.g., >2000 deg/s angular velocity). Code: notebooks/04_filtering.ipynb -> apply_guardrails() |

---

## step_05: Reference detection - automatic static pose identification and anatomical calibration per Rácz et al. (2025). Establishes neutral pose for relative angle computation. Generated by notebooks/05_reference.ipynb

**File Suffix:** `__reference_summary.json`

| Parameter Path | Type | Section | Description |
|----------------|------|---------|-------------|
| `run_id` | str | S0 | Recording identifier for continuity |
| `subject_context.height_cm` | float | S0 | Subject height computed from skeleton in reference pose. Formula: $h = \|p_{head} - p_{foot\_midpoint}\|_2$ in global frame. Cross-validated against metadata. Used for anthropometric scaling and sanity checks. Code: notebooks/05_reference.ipynb -> compute_subject_height() |
| `subject_context.scaling_factor` | float | S0 | Scale factor applied to normalize skeleton. Default: 1.0 (no scaling). Non-unity indicates size normalization for cross-subject comparison |
| `subject_context.height_status` | str | S0 | Height validation result: PASS (within 10% of metadata), REVIEW (10-20% deviation), FAIL (>20% or impossible value). Catches unit errors or wrong subject association |
| `static_offset_audit.Left.measured_angle_deg` | float | S1 | Left arm abduction angle from vertical in reference pose. Measures T-pose deviation. Formula: $\theta = \arccos(\hat{v}_{arm} \cdot \hat{v}_{vertical})$. Threshold per Rácz: <15° acceptable. Used to correct systematic arm offset in joint angles. Code: notebooks/05_reference.ipynb -> compute_arm_offset() |
| `static_offset_audit.Right.measured_angle_deg` | float | S1 | Right arm abduction angle from vertical in reference pose. Asymmetry between L/R may indicate postural habit or marker placement inconsistency |
| `window_metadata.start_time_sec` | float | S5 | Start time (seconds) of detected static reference window. Window selected for minimal motion variance across key joints (Hips, Hands). Code: notebooks/05_reference.ipynb -> detect_static_window() |
| `window_metadata.end_time_sec` | float | S5 | End time (seconds) of static window. Typical duration: 0.5-2.0 seconds. Longer windows reduce noise but may include micro-movements |
| `window_metadata.variance_score` | float | S5 | Motion variance in detected window. Formula: $V = \sum_{j \in joints} \text{Var}(p_j(t))$ for t in window. Lower = more stable reference. Used to rank candidate windows |
| `window_metadata.ref_quality_score` | float | S5 | Normalized reference quality score [0-1]. Combines variance, duration, and temporal position factors. Formula: $Q = w_1(1-V_{norm}) + w_2 D_{norm} + w_3 T_{penalty}$. Threshold: >0.7 for HIGH confidence. Code: notebooks/05_reference.ipynb -> score_reference_window() |
| `window_metadata.confidence_level` | str | S5 | Categorical confidence: HIGH (Q>0.8, clear static period), MEDIUM (0.6-0.8, acceptable), LOW (<0.6, no clear static pose). LOW triggers fallback to first-frame reference |
| `window_metadata.detection_method` | str | S5 | Algorithm used: 'auto_stable_window' (sliding window variance minimization), 'first_frame_fallback' (if no stable period found), 'manual_override' (user-specified) |
| `metadata.grade` | str | S5 | Overall reference quality grade: HIGH/MEDIUM/LOW. Aggregates confidence and offset severity. Used in score_reference() quality scoring |
| `metadata.status` | str | S5 | Reference lock status: 'LOCKED' (validated, used for all angle computations), 'PROVISIONAL' (needs manual confirmation), 'REJECTED' (unusable, pipeline halted) |

---

## step_06: Kinematics summary - angular velocity computation via quaternion differentiation, outlier detection, and movement characterization. Final QC gate before research use. Generated by notebooks/06_rotvec_omega.ipynb

**File Suffix:** `__kinematics_summary.json`

| Parameter Path | Type | Section | Description |
|----------------|------|---------|-------------|
| `run_id` | str | S0 | Recording identifier completing the pipeline chain |
| `overall_status` | str | S8 | Pipeline completion status. Values: 'COMPLETED_STEP_06' (full pipeline success), 'PARTIAL' (some joints failed), 'FAILED' (critical error). Logged to overall_gate_status for batch processing |
| `metrics.angular_velocity.max` | float | S6 | Maximum angular velocity across all joints and frames (deg/s). Formula: $\omega_{max} = \max_{j,t} \|\omega_j(t)\|$ where $\omega = 2 \cdot \frac{dq}{dt} \cdot q^*$ (quaternion derivative method). Physiological limits: Normal movement <800, Athletic <1500, Gaga dance up to 2250 deg/s (distal segments). Exceeding 2500 suggests tracking artifact. Code: notebooks/06_rotvec_omega.ipynb -> compute_angular_velocity() |
| `metrics.angular_velocity.limit` | float | S6 | Configurable physiological limit for angular velocity (deg/s). Default: 1500 (athletic baseline). Set in config_v1.yaml. Used for outlier classification threshold |
| `metrics.angular_accel.max` | float | S6 | Maximum angular acceleration (deg/s²). Formula: $\alpha_{max} = \max_{j,t} \|\frac{d\omega}{dt}\|$. Computed via Savitzky-Golay differentiation of angular velocity. Thresholds: ACCEPTABLE<30k (smooth movement), HIGH 30-50k (rapid transitions), EXTREME>50k (potential artifact or impact). Code: notebooks/06_rotvec_omega.ipynb -> compute_angular_acceleration() |
| `metrics.linear_accel.max` | float | S6 | Maximum linear acceleration of any segment endpoint (mm/s²). Injury risk indicator for impacts. Formula: $a_{max} = \max_{j,t} \|\ddot{p}_j(t)\|$. Thresholds: SAFE<50k (normal), ELEVATED 50-100k (high intensity), SEVERE>100k (impact/fall). Units converted to m/s² for comparison with literature |
| `signal_quality.avg_residual_rms` | float | S7 | Mean RMS residual across all filtered signals. Formula: $\overline{RMS} = \frac{1}{N_j}\sum_{j=1}^{N_j} RMS_j$. Aggregates 'price of smoothing' from step_04. Policy: GOLD<15mm (minimal distortion), SILVER 15-30mm (acceptable for research), REVIEW>30mm (filter may be removing signal). Code: notebooks/06_rotvec_omega.ipynb -> aggregate_signal_quality() |
| `signal_quality.max_quat_norm_err` | float | S2 | Maximum quaternion normalization error across all frames. Formula: $\epsilon_{max} = \max_{j,t} |\|q_{j,t}\| - 1|$. Should be <1e-6 after normalization. Values >0.01 indicate numerical instability or corrupted quaternions. ISB compliance requires unit quaternions. Code: notebooks/06_rotvec_omega.ipynb -> validate_quaternion_norms() |
| `movement_metrics.path_length_mm` | float | S6 | Total 3D path length of root segment (Hips) in mm. Formula: $L = \sum_{t=1}^{N-1} \|p(t+1) - p(t)\|$. Measures total displacement during recording. Used for movement intensity characterization and cross-recording normalization |
| `movement_metrics.intensity_index` | float | S6 | Normalized movement intensity index. Formula: $I = \frac{\sum_j \sum_t \|\omega_j(t)\| \cdot \Delta t}{m \cdot T}$ where m=body mass (kg), T=duration. Units: (deg·s)/(kg·s) = deg/kg. Enables cross-subject comparison. Higher values indicate more vigorous movement. Code: notebooks/06_rotvec_omega.ipynb -> compute_intensity_index() |
| `outlier_analysis.counts.total_outliers` | int | S6 | Total frames flagged as outliers across all joints. Outlier = exceeds any threshold (velocity, acceleration, or jerk). Used for data_usable determination. Policy: >5% triggers REVIEW |
| `outlier_analysis.percentages.total_outliers` | float | S6 | Percentage of frames with at least one outlier. Formula: $\frac{N_{outlier}}{N_{total}} \times 100$. Key decision metric. Thresholds: <1% ACCEPT, 1-5% REVIEW, >5% requires manual inspection. Code: notebooks/06_rotvec_omega.ipynb -> compute_outlier_statistics() |
| `outlier_analysis.consecutive_runs.max_consecutive_any_outlier` | int | S6 | Longest run of consecutive outlier frames. Classification per burst analysis: 1-3 frames = Artifact (spike), 4-7 frames = Burst (rapid movement), 8+ frames = Flow (sustained high intensity). Artifacts excluded from clean statistics; Bursts/Flows preserved as legitimate Gaga movement. Code: notebooks/06_rotvec_omega.ipynb -> classify_outlier_runs() |
| `pipeline_params.sg_window_sec` | float | S6 | Savitzky-Golay filter window for differentiation (seconds). Default: 0.175s (21 frames at 120Hz). Balances noise reduction vs. temporal resolution. Polynomial order fixed at 3. Code: scipy.signal.savgol_filter() |
| `pipeline_params.fs_target` | float | S2 | Confirmed target sampling rate used for all time-derivative calculations. Must match step_03 target_fs for consistent frequency analysis |

---
